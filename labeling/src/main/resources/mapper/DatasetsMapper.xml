<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dlabeling.labeling.mapper.DatasetsMapper">


    <insert id="addDatasets">
        INSERT INTO `datasets`
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="true">`name`,</if>
            <if test="description != null or description != ''"> `description`,</if>
            <if test="true">`type`,</if>
            <if test="true">`data_root_dir`,</if>
            <if test="true">`label_root_dir`,</if>
            <if test="visible != null or visible != ' '">`visible`,</if>
            <if test="true">`create_time`,</if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="true">#{name},</if>
            <if test="description != null or description != ''"> #{description},</if>
            <if test="true">#{type},</if>
            <if test="true">#{dataRootDir},</if>
            <if test="true">#{labelRootDir},</if>
            <if test="visible != null or visible != ''">#{visible},</if>
            <choose>
                <when test="createTime != null">#{createTime},</when>
                <otherwise>CURRENT_TIMESTAMP,</otherwise>
            </choose>

        </trim>
    </insert>

    <select id="getAll" resultType="com.dlabeling.labeling.domain.po.Datasets">
        SELECT
            `id`,
            `name`,
            `description`,
            `type`,
            `data_root_dir`,
            `visible`,
            `create_time`,
            `update_time`,
            `destroy_time`
        FROM `datasets`
    </select>

    <update id="updateDatasetsByID">
        UPDATE `datasets`
        <set>
            <trim suffixOverrides=",">
                <if test="name != null and name != ''">`name` = #{name},</if>
                <if test="description != null and description != ''"> `description` = #{description},</if>
                <if test="dataRootDir != null and dataRootDir != ''">`data_root_dir` = #{dataRootDir},</if>
                <if test="visible != null">`visible` = #{visible},</if>
                <if test="updateTime != null"> `update_time` = #{updateTime},</if>
                <if test="destroyTime != null"> `destroy_time` = #{destroyTime},</if>
            </trim>
        </set>
        <where>
            `id` = #{id}
        </where>
    </update>

    <delete id="deleteDatasetsByID">
        DELETE FROM `datasets` WHERE `id` = #{id}
    </delete>

    <select id="selectByObj" resultType="com.dlabeling.labeling.domain.po.Datasets">
        SELECT
            `id`,
            `name`,
            `description`,
            `type`,
            `data_root_dir`,
            `visible`,
            `create_time`,
            `update_time`,
            `destroy_time`
        FROM `datasets`
        <where>
            <trim suffixOverrides="AND">
                <if test="true"> `name` = #{name} AND</if>
                <if test="description != null"> `description` = #{description} AND </if>
                <if test="type != null"> `type` = #{type} AND</if>
                <if test="dataRootDir != null"> `data_root_dir` = #{dataRootDir} AND</if>
                <if test="visible != null"> `visible` = #{visible} AND</if>
            </trim>
        </where>
    </select>

</mapper>